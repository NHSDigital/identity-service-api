{"completed": true, "point": [{"id": "Paused", "results": []}, {"id": "Resumed", "results": []}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "REQ_HEADERS_PARSED"}, {"name": "From", "value": "REQ_START"}]}, "timestamp": "04-11-21 14:51:06:496"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Apigee.client.connection", "value": "3.11.106.35:57234;35.234.138.138:443;ssl"}, {"name": "X-Apigee.Host", "value": "internal-dev.api.service.nhs.uk:443"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.Message-Timeout", "value": "57"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "environment.name", "value": "internal-dev"}, {"name": "environment.qualifiedname", "value": "nhsd-nonprod__internal-dev"}, {"name": "environment.orgname", "value": "nhsd-nonprod"}]}, "timestamp": "04-11-21 14:51:06:496"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "organization.name", "value": "nhsd-nonprod"}]}, "timestamp": "04-11-21 14:51:06:496"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "apiproxy.qualifiedname", "value": "identity-service-pr-251__14"}, {"name": "apiproxy.basepath", "value": "/"}, {"name": "apiproxy.revision", "value": "14"}, {"name": "apiproxy.name", "value": "identity-service-pr-251"}]}, "timestamp": "04-11-21 14:51:06:496"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.basepath", "value": "oauth2-pr-251"}, {"name": "proxy.pathsuffix", "value": "/callback"}, {"name": "proxy.url", "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}, {"name": "proxy.name", "value": "default"}, {"name": "proxy.client.ip", "value": "3.11.106.35"}]}, "timestamp": "04-11-21 14:51:06:496"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "virtualhost.aliases.values", "value": "[\"nhsd-nonprod-internal-dev.apigee.net\",\"internal-dev.api.service.nhs.uk\"]"}, {"name": "virtualhost.port", "value": "443"}, {"name": "virtualhost.name", "value": "secure"}, {"name": "virtualhost.ssl.enabled", "value": "true"}, {"name": "virtualhost.aliases", "value": "{nhsd-nonprod-internal-dev.apigee.net,internal-dev.api.service.nhs.uk}"}, {"name": "virtualhost.ip", "value": "35.234.138.138"}]}, "timestamp": "04-11-21 14:51:06:496"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": []}, "timestamp": "04-11-21 14:51:06:497"}]}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "PROXY_REQ_FLOW"}, {"name": "From", "value": "REQ_HEADERS_PARSED"}]}, "timestamp": "04-11-21 14:51:06:497"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "type", "value": "FlowHookAction"}]}, "timestamp": "04-11-21 14:51:06:497"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": []}]}, {"id": "FlowCallout", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "PreProxyFlowHook->PreProxySharedFlow"}]}, "timestamp": "04-11-21 14:51:06:497"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "keyvaluemapoperations"}, {"name": "type", "value": "KeyValueMapOperationsExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "KeyValueMapOperations.GetCommonSecrets"}, {"name": "stepDefinition-name", "value": "KeyValueMapOperations.GetCommonSecrets"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:497"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetCommonSecrets.timeTaken", "success": true, "value": "38572"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "keyvaluemapoperations"}, {"name": "type", "value": "KeyValueMapOperationsExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "KeyValueMapOperations.GetConfigClear"}, {"name": "stepDefinition-name", "value": "KeyValueMapOperations.GetConfigClear"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:500"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Set": {"name": "apim.feature_toggles_raw", "success": true, "value": "{\"enable-token-exchange\": true, \"enable-nhs-login-combined-auth\": true, \"enable-citizen-access\": true}"}}, {"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetConfigClear.timeTaken", "success": true, "value": "2548242"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "keyvaluemapoperations"}, {"name": "type", "value": "KeyValueMapOperationsExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "KeyValueMapOperations.GetConfigEncrypted"}, {"name": "stepDefinition-name", "value": "KeyValueMapOperations.GetConfigEncrypted"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:505"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetConfigEncrypted.timeTaken", "success": true, "value": "4995983"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "UnpackVars.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Javascript.UnpackVars"}, {"name": "stepDefinition-name", "value": "Javascript.UnpackVars"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:505"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Get": {"name": "apim.vars_raw"}}, {"Get": {"name": "apim.feature_toggles_raw", "value": "{\"enable-token-exchange\": true, \"enable-nhs-login-combined-auth\": true, \"enable-citizen-access\": true}"}}, {"Set": {"name": "apim.feature_toggles.enable-token-exchange", "success": true, "value": "true"}}, {"Set": {"name": "apim.feature_toggles.enable-nhs-login-combined-auth", "success": true, "value": "true"}}, {"Set": {"name": "apim.feature_toggles.enable-citizen-access", "success": true, "value": "true"}}, {"Set": {"name": "apigee.metrics.policy.Javascript.UnpackVars.timeTaken", "success": true, "value": "244510"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Copy.RequestDataForSplunk"}, {"name": "stepDefinition-name", "value": "AssignMessage.Copy.RequestDataForSplunk"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:506"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Get": {"name": "request.uri", "value": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Set": {"name": "request-data-for-splunk.uri", "success": true, "value": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "request.url"}}, {"Set": {"name": "request-data-for-splunk.url", "success": true, "value": ""}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.Copy.RequestDataForSplunk.timeTaken", "success": true, "value": "70539"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Copy.RequestHeaders"}, {"name": "stepDefinition-name", "value": "AssignMessage.Copy.RequestHeaders"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:506"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Get": {"name": "original-request-details"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.Copy.RequestHeaders.timeTaken", "success": true, "value": "6505"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Set.NHSDCorrelationIDHeader"}, {"name": "stepDefinition-name", "value": "AssignMessage.Set.NHSDCorrelationIDHeader"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:506"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Get": {"name": "message.header.X-Request-ID"}}, {"Get": {"name": "message.header.X-Correlation-ID"}}, {"Get": {"name": "messageid", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}}, {"Set": {"name": "message.header.NHSD-Correlation-ID", "success": true, "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.Set.NHSDCorrelationIDHeader.timeTaken", "success": true, "value": "14578"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Set.NHSDRequestIDHeader"}, {"name": "stepDefinition-name", "value": "AssignMessage.Set.NHSDRequestIDHeader"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:506"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "current.flow"}}, {"Get": {"name": "message.header.X-Request-ID"}}, {"Set": {"name": "message.header.NHSD-Request-ID", "success": true, "value": ""}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.Set.NHSDRequestIDHeader.timeTaken", "success": true, "value": "5090"}}]}]}, {"id": "FlowReturn", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "PreProxyFlowHook->PreProxySharedFlow"}]}, "timestamp": "04-11-21 14:51:06:506"}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(\"default\" equals proxy.name)"}, {"name": "Tree", "value": "PROXY_default"}]}, "timestamp": "04-11-21 14:51:06:506"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.edge.sharedflow.name", "success": true}}, {"Set": {"name": "apigee.edge.flowhook.name", "success": true}}, {"Get": {"name": "proxy.name", "value": "default"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "PreFlow"}]}, "timestamp": "04-11-21 14:51:06:506"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "PreFlow"}]}, "timestamp": "04-11-21 14:51:06:506"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "keyvaluemapoperations"}, {"name": "type", "value": "KeyValueMapOperationsExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "KeyValueMapOperations.GetIdentityServiceConfig"}, {"name": "stepDefinition-name", "value": "KeyValueMapOperations.GetIdentityServiceConfig"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:511"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetIdentityServiceConfig.timeTaken", "success": true, "value": "5052437"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "UnpackVars.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Javascript.UnpackVars"}, {"name": "stepDefinition-name", "value": "Javascript.UnpackVars"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "identity-service-config.cis2.access_token_expiry_ms", "success": true, "value": "600000"}}, {"Set": {"name": "identity-service-config.cis2.client_id", "success": true, "value": "test-client-1"}}, {"Set": {"name": "identity-service-config.cis2.refresh_token_expiry_ms", "success": true, "value": "3600000"}}, {"Set": {"name": "identity-service-config.cis2.refresh_tokens_validity_ms", "success": true, "value": "3600000"}}, {"Set": {"name": "identity-service-config.cis2.simulated_idp", "success": true, "value": "false"}}, {"Set": {"name": "identity-service-config.cis2.issuer", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "identity-service-config.cis2.access_token_path", "success": true, "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "identity-service-config.cis2.jwks_path", "success": true, "value": "/auth/realms/cis2-mock/protocol/openid-connect/certs"}}, {"Set": {"name": "identity-service-config.cis2.redirect_uri", "success": true, "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback"}}, {"Set": {"name": "identity-service-config.cis2.authorize_endpoint", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock/protocol/openid-connect/auth"}}, {"Set": {"name": "identity-service-config.cis2.userinfo_path", "success": true, "value": "/auth/realms/cis2-mock/protocol/openid-connect"}}, {"Set": {"name": "identity-service-config.cis2.backchannel_allowed_ips", "success": true, "value": "[{\"address\": \"0.0.0.0\", \"mask\": \"1\"}, {\"address\": \"128.0.0.0\", \"mask\": \"1\"}]"}}, {"Set": {"name": "identity-service-config.nhs_login.jwks_path", "success": true, "value": "/mock-nhsid-jwks/identity-service/nhs-login-jwks"}}, {"Set": {"name": "identity-service-config.nhs_login.client_id", "success": true, "value": "some-client-id"}}, {"Set": {"name": "identity-service-config.nhs_login.issuer", "success": true, "value": "https://internal-dev.api.service.nhs.uk"}}, {"Set": {"name": "identity-service-config.nhs_login.audience", "success": true, "value": "https://internal-dev.api.service.nhs.uk/mock-nhsid-jwks/nhs_login_simulated_token"}}, {"Set": {"name": "identity-service-config.nhs_login.authorize_endpoint", "success": true, "value": "https://internal-dev.api.service.nhs.uk/mock-nhsid-jwks/nhs_login_simulated_auth"}}, {"Set": {"name": "identity-service-config.nhs_login.access_token_path", "success": true, "value": "/mock-nhsid-jwks/nhs_login_simulated_token"}}, {"Set": {"name": "identity-service-config.nhs_login.kid", "success": true, "value": "test-1"}}, {"Set": {"name": "identity-service-config.nhs_login.redirect_uri", "success": true, "value": "https://internal-dev.api.service.nhs.uk/oauth2/callback"}}, {"Set": {"name": "apigee.metrics.policy.Javascript.UnpackVars.timeTaken", "success": true, "value": "295039"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.setIDPvar"}, {"name": "stepDefinition-name", "value": "AssignMessage.setIDPvar"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "idp", "success": true, "value": "null"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.setIDPvar.timeTaken", "success": true, "value": "12729"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "expression", "value": "(apim.feature_toggles.enable-nhs-login-combined-auth equals true)"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "true"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.ExtractExternalScope"}, {"name": "stepDefinition-name", "value": "AssignMessage.ExtractExternalScope"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "request.queryparam.scope"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.ExtractExternalScope.timeTaken", "success": true, "value": "4916"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.RemoveExternalScope"}, {"name": "stepDefinition-name", "value": "AssignMessage.RemoveExternalScope"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.AssignMessage.RemoveExternalScope.timeTaken", "success": true, "value": "4693"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Set APIM Guids"}, {"name": "stepDefinition-name", "value": "AssignMessage.SetApimGuids"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apim.api_guid", "success": true, "value": "d5a3f4fc-e61f-41f3-ab72-16aa5ef3ff2b"}}, {"Set": {"name": "apim.api_spec_guid", "success": true, "value": ""}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.SetApimGuids.timeTaken", "success": true, "value": "4587"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /_ping and ((request.verb equals \"GET\") or (request.verb equals \"HEAD\")))"}, {"name": "Tree", "value": "AddPayloadToPing_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /authorize and (request.verb equals \"GET\"))"}, {"name": "Tree", "value": "Flow.GetAuthorization_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and ((request.formparam.grant_type equals \"client_credentials\") and (request.formparam.subject_token_type not equals \"urn:ietf:params:oauth:token-type:id_token\"))))"}, {"name": "Tree", "value": "Flow.PostTokenClientCredentials_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and ((request.formparam.subject_token_type equals \"urn:ietf:params:oauth:token-type:id_token\") and (apim.feature_toggles.enable-token-exchange equals true))))"}, {"name": "Tree", "value": "Flow.PostTokenTokenExchange_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /backchannel_logout and (request.verb equals \"POST\"))"}, {"name": "Tree", "value": "Flow.BackChannelLogout_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and (request.formparam.grant_type equals \"authorization_code\")))"}, {"name": "Tree", "value": "Flow.PostTokenAuthorizationCode_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and (request.formparam.grant_type equals \"refresh_token\")))"}, {"name": "Tree", "value": "Flow.PostRefreshToken_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /callback and (request.verb equals \"GET\"))"}, {"name": "Tree", "value": "Flow.GetCallback_REQUEST_FLOW"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}, {"Get": {"name": "request.verb", "value": "GET"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "Flow.GetCallback"}, {"name": "proxy.flow.description", "value": "Flow to catch the Code response"}]}, "timestamp": "04-11-21 14:51:06:512"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "Flow.GetCallback"}, {"name": "current.flow.description", "value": "Flow to catch the Code response"}]}, "timestamp": "04-11-21 14:51:06:512"}]}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "lookupcache.LookupCache.OriginalClientInfo.cachekey", "value": "nhsd-nonprod__internal-dev__identity-service-pr-251__default__crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht__original_client"}, {"name": "lookupcache.LookupCache.OriginalClientInfo.cachename", "value": "nhsd-nonprod__internal-dev__client-state"}, {"name": "lookupcache.LookupCache.OriginalClientInfo.failed", "value": "false"}, {"name": "lookupcache.LookupCache.OriginalClientInfo.fault.cause", "value": ""}, {"name": "lookupcache.LookupCache.OriginalClientInfo.fault.name", "value": ""}, {"name": "lookupcache.LookupCache.OriginalClientInfo.cachehit", "value": "false"}, {"name": "lookupcache.LookupCache.OriginalClientInfo.assignto", "value": "client-state"}, {"name": "lookupcache.LookupCache.OriginalClientInfo.isEncrypted", "value": "false"}]}, "timestamp": "04-11-21 14:51:06:512"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "PAUSE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "lookupcache"}, {"name": "type", "value": "LookupCacheExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "LookupCache.OriginalClientInfo"}, {"name": "stepDefinition-name", "value": "LookupCache.OriginalClientInfo"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:512"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "lookupcache.LookupCache.OriginalClientInfo"}}, {"Get": {"name": "target"}}, {"Get": {"name": "request.queryparam.state", "value": "crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht"}}, {"Set": {"name": "apigee.metrics.policy.LookupCache.OriginalClientInfo.timeTaken", "success": true, "value": "68718"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "extractvariables"}, {"name": "type", "value": "ExtractVariablesExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ExtractVariables.ReadCacheJson"}, {"name": "stepDefinition-name", "value": "ExtractVariables.ReadCacheJson"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:515"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "client-state", "value": "{\"client_id\":\"8z3lF1KOiIRvua1g5GXvpp5G76BUQazx\",\"redirect_uri\":\"https://httpbin.org/anything\",\"state\":\"45e71699-70ec-4271-8274-c97f76a62f4e\",\"response_type\":\"code\",\"scope\":\"urn:nhsd:apim:user-nhs-login:P9:some-api urn:nhsd:apim:app:level3: urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service urn:nhsd:apim:user-nhs-login:P5:some-api personal-demographics-service:USER-RESTRICTED urn:nhsd:apim:user-nhs-login:P0:some-api\",\"idp\":\"null\"}"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "original_client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "original_redirect_uri", "success": true, "value": "https://httpbin.org/anything"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "original_state", "success": true, "value": "45e71699-70ec-4271-8274-c97f76a62f4e"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "original_response_type", "success": true, "value": "code"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "original_scope", "success": true, "value": "urn:nhsd:apim:user-nhs-login:P9:some-api urn:nhsd:apim:app:level3: urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service urn:nhsd:apim:user-nhs-login:P5:some-api personal-demographics-service:USER-RESTRICTED urn:nhsd:apim:user-nhs-login:P0:some-api"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "idp", "success": true, "value": "null"}}, {"Set": {"name": "apigee.metrics.policy.ExtractVariables.ReadCacheJson.timeTaken", "success": true, "value": "758867"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "invalidatecache"}, {"name": "type", "value": "InvalidateCacheExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "InvalidateCache.OriginalClientInfo"}, {"name": "stepDefinition-name", "value": "InvalidateCache.OriginalClientInfo"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:516"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "target"}}, {"Get": {"name": "request.queryparam.state", "value": "crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht"}}, {"Set": {"name": "apigee.metrics.policy.InvalidateCache.OriginalClientInfo.timeTaken", "success": true, "value": "327196"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "oauthV2.VerifyAPIKey.FromJSON.failed", "value": "false"}, {"name": "oauthV2.VerifyAPIKey.FromJSON.fault.name", "value": ""}, {"name": "oauthV2.VerifyAPIKey.FromJSON.fault.cause", "value": ""}]}, "timestamp": "04-11-21 14:51:06:530"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "Identifier", "value": "verifyapikey.VerifyAPIKey.FromJSON.app"}]}, "timestamp": "04-11-21 14:51:06:530"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "Identifier", "value": "verifyapikey.VerifyAPIKey.FromJSON.developer"}]}, "timestamp": "04-11-21 14:51:06:530"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "oauthV2"}, {"name": "type", "value": "VerifyApiKeyStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "VerifyAPIKey.FromJSON"}, {"name": "stepDefinition-name", "value": "VerifyAPIKey.FromJSON"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:530"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "oauthV2.VerifyAPIKey.FromJSON"}}, {"Get": {"name": "flow.resource.name"}}, {"Get": {"name": "original_client_id", "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.jwks-resource-url", "success": true, "value": "https://raw.githubusercontent.com/NHSDigital/identity-service-jwks/main/jwks/internal-dev/9baed6f4-1361-4a8e-8531-1f8426e3aba8.json"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.limit", "success": true, "value": "60000"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.redirection_uris", "success": true, "value": "https://httpbin.org/anything"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.ratelimit", "success": true, "value": "1000ps"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.interval", "success": true, "value": "1"}}, {"Set": {"name": "apiproduct.name", "success": true, "value": "apim-auto-d8fcd097-70a2-4855-a5ed-38d32918e42b"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.name", "success": true, "value": "apim-auto-d8fcd097-70a2-4855-a5ed-38d32918e42b"}}, {"Set": {"name": "developer.email", "success": true, "value": "apm-testing-internal-dev@nhs.net"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.developer.email", "success": true, "value": "apm-testing-internal-dev@nhs.net"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.issued_at", "success": true, "value": "1636037442355"}}, {"Set": {"name": "client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.developer.app.id", "success": true, "value": "d93681cd-e785-4180-9282-7621420b2fac"}}, {"Set": {"name": "developer.id", "success": true, "value": "nhsd-nonprod@@@ba00a768-3783-46f6-bf41-4033d2bf669d"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.developer.id", "success": true, "value": "nhsd-nonprod@@@ba00a768-3783-46f6-bf41-4033d2bf669d"}}, {"Set": {"name": "developer.app.name", "success": true, "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.developer.app.name", "success": true, "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.DisplayName", "success": true, "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.client_secret", "success": true, "value": "SyQEm8PrDoRfIkH6"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.expires_in", "success": true, "value": "0"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.access", "success": true, "value": "public"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.status", "success": true, "value": "approved"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.timeunit", "success": true, "value": "minute"}}, {"Set": {"name": "apigee.apiproduct.name", "success": true, "value": "apim-auto-d8fcd097-70a2-4855-a5ed-38d32918e42b"}}, {"Set": {"name": "apigee.developer.email", "success": true, "value": "apm-testing-internal-dev@nhs.net"}}, {"Set": {"name": "apigee.client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Set": {"name": "apigee.developer.id", "success": true, "value": "nhsd-nonprod@@@ba00a768-3783-46f6-bf41-4033d2bf669d"}}, {"Set": {"name": "apigee.developer.app.name", "success": true, "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Set": {"name": "developer.app.id", "success": true, "value": "d93681cd-e785-4180-9282-7621420b2fac"}}, {"Set": {"name": "verifyapikey.VerifyAPIKey.FromJSON.failed", "success": true, "value": "false"}}, {"Set": {"name": "oauthV2.failed", "success": true, "value": "false"}}, {"Set": {"name": "apigee.metrics.policy.VerifyAPIKey.FromJSON.timeTaken", "success": true, "value": "13530854"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "flowcallout"}, {"name": "type", "value": "FlowCalloutStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Apply Rate Limiting"}, {"name": "stepDefinition-name", "value": "FlowCallout.ApplyRatelimitingFromJSON"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:530"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.FlowCallout.ApplyRatelimitingFromJSON.timeTaken", "success": true, "value": "17580"}}]}]}, {"id": "FlowCallout", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "ApplyRateLimiting"}]}, "timestamp": "04-11-21 14:51:06:530"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "set-ratelimits.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Javascript.SetRatelimits"}, {"name": "stepDefinition-name", "value": "Javascript.SetRatelimits"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:530"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "verifyApiKeyPolicyName", "value": "VerifyAPIKey.FromJSON"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.limit", "value": "60000"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.interval", "value": "1"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.developer.quota.timeunit", "value": "minute"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.ratelimit", "value": "1000ps"}}, {"Get": {"name": "ratelimiting", "value": "{\n    \"app\": {\n        \"quota\": {\n            \"enabled\": true,\n            \"interval\": 1,\n            \"limit\": 300,\n            \"timeunit\": \"minute\"\n        },\n        \"spikeArrest\": {\n            \"enabled\": false\n        }\n    },\n    \"proxy\": {\n        \"quota\": {\n            \"enabled\": false\n        },\n        \"spikeArrest\": {\n            \"enabled\": true,\n            \"ratelimit\": \"300000pm\"\n        }\n    }\n}"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.app.ratelimiting"}}, {"Get": {"name": "verifyapikey.VerifyAPIKey.FromJSON.apiproduct.ratelimiting"}}, {"Get": {"name": "ratelimiting", "value": "{\n    \"app\": {\n        \"quota\": {\n            \"enabled\": true,\n            \"interval\": 1,\n            \"limit\": 300,\n            \"timeunit\": \"minute\"\n        },\n        \"spikeArrest\": {\n            \"enabled\": false\n        }\n    },\n    \"proxy\": {\n        \"quota\": {\n            \"enabled\": false\n        },\n        \"spikeArrest\": {\n            \"enabled\": true,\n            \"ratelimit\": \"300000pm\"\n        }\n    }\n}"}}, {"Set": {"name": "proxy_quota_enabled", "success": true, "value": "false"}}, {"Set": {"name": "proxy_spikeArrest_enabled", "success": true, "value": "true"}}, {"Set": {"name": "proxy_spikeArrest_ratelimit", "success": true, "value": "300000pm"}}, {"Set": {"name": "app_quota_limit", "success": true, "value": "300"}}, {"Set": {"name": "app_quota_interval", "success": true, "value": "1"}}, {"Set": {"name": "app_quota_timeunit", "success": true, "value": "minute"}}, {"Set": {"name": "app_quota_enabled", "success": true, "value": "true"}}, {"Set": {"name": "app_spikeArrest_ratelimit", "success": true, "value": "1000ps"}}, {"Set": {"name": "app_spikeArrest_enabled", "success": true, "value": "false"}}, {"Set": {"name": "apigee.metrics.policy.Javascript.SetRatelimits.timeTaken", "success": true, "value": "334265"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ratelimit.QuotaPerApp.expiry.time", "value": "1636037466531"}, {"name": "ratelimit.QuotaPerApp.failed", "value": "false"}, {"name": "ratelimit.QuotaPerApp.datastore.fail.open", "value": "false"}, {"name": "ratelimit.QuotaPerApp.class.total.exceed.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.allowed.count", "value": "300"}, {"name": "ratelimit.QuotaPerApp.fault.name", "value": ""}, {"name": "ratelimit.QuotaPerApp.class.used.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.class.available.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.total.exceed.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.class.allowed.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.used.count", "value": "2"}, {"name": "ratelimit.QuotaPerApp.identifier", "value": "d93681cd-e785-4180-9282-7621420b2fac"}, {"name": "ratelimit.QuotaPerApp.exceed.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.class.exceed.count", "value": "0"}, {"name": "ratelimit.QuotaPerApp.available.count", "value": "298"}, {"name": "ratelimit.QuotaPerApp.fault.cause", "value": ""}]}, "timestamp": "04-11-21 14:51:06:536"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "Quota"}, {"name": "expression", "value": "(app_quota_enabled equals true)"}, {"name": "type", "value": "RateLimitExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "true"}, {"name": "expressionResult", "value": "true"}, {"name": "stepDefinition-displayName", "value": "Quota Per App"}, {"name": "stepDefinition-name", "value": "QuotaPerApp"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "app_quota_interval", "value": "1"}}, {"Get": {"name": "app_quota_timeunit", "value": "minute"}}, {"Get": {"name": "developer.app.id", "value": "d93681cd-e785-4180-9282-7621420b2fac"}}, {"Get": {"name": "app_quota_limit", "value": "300"}}, {"Set": {"name": "apigee.metrics.policy.QuotaPerApp.timeTaken", "success": true, "value": "5096928"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(ratelimit.QuotaPerApp.failed equals true)"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.QuotaPerApp"}, {"name": "stepDefinition-name", "value": "RaiseFault.QuotaPerApp"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "app_quota_interval", "value": "1"}}, {"Get": {"name": "app_quota_timeunit", "value": "minute"}}, {"Get": {"name": "developer.app.id", "value": "d93681cd-e785-4180-9282-7621420b2fac"}}, {"Get": {"name": "app_quota_limit", "value": "300"}}, {"Set": {"name": "apigee.metrics.policy.QuotaPerApp.timeTaken", "success": true, "value": "5096928"}}, {"Get": {"name": "ratelimit.QuotaPerApp.failed", "value": "false"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "SpikeArrest"}, {"name": "expression", "value": "(app_spikeArrest_enabled equals true)"}, {"name": "type", "value": "RateLimitExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "true"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Per-app Spike Arrest"}, {"name": "stepDefinition-name", "value": "SpikeArrestPerApp"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "app_spikeArrest_enabled", "value": "false"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(ratelimit.SpikeArrestPerApp.failed equals true)"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.SpikeArrestPerApp"}, {"name": "stepDefinition-name", "value": "RaiseFault.SpikeArrestPerApp"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "ratelimit.SpikeArrestPerApp.failed"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "Quota"}, {"name": "expression", "value": "(proxy_quota_enabled equals true)"}, {"name": "type", "value": "RateLimitExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "true"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Quota Per Proxy"}, {"name": "stepDefinition-name", "value": "QuotaPerProxy"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy_quota_enabled", "value": "false"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(ratelimit.QuotaPerProxy.failed equals true)"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.QuotaPerProxy"}, {"name": "stepDefinition-name", "value": "RaiseFault.QuotaPerProxy"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "ratelimit.QuotaPerProxy.failed"}}]}]}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ratelimit.SpikeArrestPerProxy.allowed.count", "value": "300000"}, {"name": "ratelimit.SpikeArrestPerProxy.fault.name", "value": ""}, {"name": "ratelimit.SpikeArrestPerProxy.fault.cause", "value": ""}, {"name": "ratelimit.SpikeArrestPerProxy.expiry.time", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.datastore.fail.open", "value": "false"}, {"name": "ratelimit.SpikeArrestPerProxy.identifier", "value": "nhsd-nonprod@@@internal-dev@@@identity-service-pr-251@@@SpikeArrestPerProxy@@@nondistributed@@@_default"}, {"name": "ratelimit.SpikeArrestPerProxy.available.count", "value": "299999"}, {"name": "ratelimit.SpikeArrestPerProxy.used.count", "value": "1"}, {"name": "ratelimit.SpikeArrestPerProxy.total.exceed.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.class.available.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.class.total.exceed.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.exceed.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.class.exceed.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.failed", "value": "false"}, {"name": "ratelimit.SpikeArrestPerProxy.class.allowed.count", "value": "0"}, {"name": "ratelimit.SpikeArrestPerProxy.class.used.count", "value": "0"}]}, "timestamp": "04-11-21 14:51:06:536"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "SpikeArrest"}, {"name": "expression", "value": "(proxy_spikeArrest_enabled equals true)"}, {"name": "type", "value": "RateLimitExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "true"}, {"name": "stepDefinition-displayName", "value": "Per-proxy Spike Arrest"}, {"name": "stepDefinition-name", "value": "SpikeArrestPerProxy"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:536"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy_spikeArrest_ratelimit", "value": "300000pm"}}, {"Set": {"name": "apigee.metrics.policy.SpikeArrestPerProxy.timeTaken", "success": true, "value": "53408"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(ratelimit.SpikeArrestPerProxy.failed equals true)"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.SpikeArrestPerProxy"}, {"name": "stepDefinition-name", "value": "RaiseFault.SpikeArrestPerProxy"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:537"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy_spikeArrest_ratelimit", "value": "300000pm"}}, {"Set": {"name": "apigee.metrics.policy.SpikeArrestPerProxy.timeTaken", "success": true, "value": "53408"}}, {"Get": {"name": "ratelimit.SpikeArrestPerProxy.failed", "value": "false"}}]}]}, {"id": "FlowReturn", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "ApplyRateLimiting"}]}, "timestamp": "04-11-21 14:51:06:537"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "keyvaluemapoperations"}, {"name": "type", "value": "KeyValueMapOperationsExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "KeyValueMapOperations.GetSecureVariables"}, {"name": "stepDefinition-name", "value": "KeyValueMapOperations.GetSecureVariables"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:547"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetSecureVariables.timeTaken", "success": true, "value": "10389817"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "JWT"}, {"name": "expression", "value": "(idp equals \"nhs-login\")"}, {"name": "type", "value": "GenerateJWTStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "GenerateJWT.NHSLoginClientAssertion"}, {"name": "stepDefinition-name", "value": "GenerateJWT.NHSLoginClientAssertion"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:547"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.KeyValueMapOperations.GetSecureVariables.timeTaken", "success": true, "value": "10389817"}}, {"Get": {"name": "idp", "value": "null"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ServiceCallout.request", "value": "grant_type=authorization_code&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383&redirect_uri=https%3A%2F%2Finternal-dev.api.service.nhs.uk%2Foauth2-pr-251%2Fcallback&client_secret=efcb8d7b-406a-4764-a697-6ca30feb554a&client_id=test-client-1"}]}, "timestamp": "04-11-21 14:51:06:548"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "PAUSE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "servicecallout"}, {"name": "expression", "value": "(idp not equals \"nhs-login\")"}, {"name": "type", "value": "ServiceCalloutExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "true"}, {"name": "stepDefinition-displayName", "value": "ServiceCallout.PostTokenCis2"}, {"name": "stepDefinition-name", "value": "ServiceCallout.PostTokenCis2"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:572"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "servicecallout.request.header.Content-Type", "success": true, "value": "application/x-www-form-urlencoded"}}, {"Set": {"name": "servicecallout.request.verb", "success": true, "value": "POST"}}, {"Set": {"name": "servicecallout.request.formparam.grant_type", "success": true, "value": "authorization_code"}}, {"Get": {"name": "request.queryparam.code", "value": "059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Set": {"name": "servicecallout.request.formparam.code", "success": true, "value": "059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "identity-service-config.cis2.redirect_uri", "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback"}}, {"Set": {"name": "servicecallout.request.formparam.redirect_uri", "success": true, "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback"}}, {"Set": {"name": "servicecallout.request.formparam.client_secret", "success": true, "value": "efcb8d7b-406a-4764-a697-6ca30feb554a"}}, {"Get": {"name": "identity-service-config.cis2.client_id", "value": "test-client-1"}}, {"Set": {"name": "servicecallout.request.formparam.client_id", "success": true, "value": "test-client-1"}}, {"Get": {"name": "servicecallout.request"}}, {"Get": {"name": "identity-service-config.cis2.access_token_path", "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "servicecallout.requesturi", "success": true, "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "apigee.metrics.policy.ServiceCallout.PostTokenCis2.timeTaken", "success": true, "value": "257586"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.PostTokenCis2.target.url"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.PostTokenCis2.expectedcn"}}, {"Get": {"name": "dynamic.target"}}, {"Get": {"name": "servicecallout.requesturi", "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "apigee.metrics.policy.ServiceCallout.PostTokenCis2.timeTaken", "success": true, "value": "24605631"}}, {"Set": {"name": "servicecallout.ServiceCallout.PostTokenCis2.failed", "success": true, "value": "false"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "loadbalancing.targetserver", "value": "cis2-keycloak"}, {"name": "loadbalancing.isfallback", "value": "false"}, {"name": "loadbalancing.failedservers", "value": "[]"}]}, "timestamp": "04-11-21 14:51:06:572"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "servicecallout_ServiceCallout.PostTokenCis2.socketAgeMs", "value": "24"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isFromClientPool", "value": "false"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.socketUseCount", "value": "1"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.totalConnectionTimeMs", "value": "7"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.resolvedAddress", "value": "18.168.252.165"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.connectionStatus", "value": "CONNECTED"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.connectionTlsHandshakeTimeMs", "value": "3"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isHttpClientCached", "value": "true"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isTlsEnabled", "value": "true"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.tlsHandshakeStatus", "value": "COMPLETED"}]}, "timestamp": "04-11-21 14:51:06:572"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "servicecallout_ServiceCallout.PostTokenCis2.socketAgeMs", "value": "24"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isFromClientPool", "value": "false"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.socketUseCount", "value": "1"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.totalConnectionTimeMs", "value": "7"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.resolvedAddress", "value": "18.168.252.165"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.connectionStatus", "value": "CONNECTED"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.connectionTlsHandshakeTimeMs", "value": "3"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isHttpClientCached", "value": "true"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.isTlsEnabled", "value": "true"}, {"name": "servicecallout_ServiceCallout.PostTokenCis2.tlsHandshakeStatus", "value": "COMPLETED"}]}, "timestamp": "04-11-21 14:51:06:572"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ServiceCallout.response", "value": "{\"access_token\":\"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiI1OWNlZjg3NC02N2Q4LTRlMDAtODMwNy1mNTUyNjNhZGNhOWEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsInN1YiI6IjQyM2RmZjY3LWUwODUtNGIwNC04NDdmLTQ5MDE1NmJjNzY5MyIsInR5cCI6IkJlYXJlciIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmR....."}]}, "timestamp": "04-11-21 14:51:06:572"}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "servicecallout"}, {"name": "expression", "value": "(idp equals \"nhs-login\")"}, {"name": "type", "value": "ServiceCalloutExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ServiceCallout.PostTokenNHSLogin"}, {"name": "stepDefinition-name", "value": "ServiceCallout.PostTokenNHSLogin"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:572"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "servicecallout.request.header.Content-Type", "success": true, "value": "application/x-www-form-urlencoded"}}, {"Set": {"name": "servicecallout.request.verb", "success": true, "value": "POST"}}, {"Set": {"name": "servicecallout.request.formparam.grant_type", "success": true, "value": "authorization_code"}}, {"Get": {"name": "request.queryparam.code", "value": "059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Set": {"name": "servicecallout.request.formparam.code", "success": true, "value": "059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "identity-service-config.cis2.redirect_uri", "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback"}}, {"Set": {"name": "servicecallout.request.formparam.redirect_uri", "success": true, "value": "https://internal-dev.api.service.nhs.uk/oauth2-pr-251/callback"}}, {"Set": {"name": "servicecallout.request.formparam.client_secret", "success": true, "value": "efcb8d7b-406a-4764-a697-6ca30feb554a"}}, {"Get": {"name": "identity-service-config.cis2.client_id", "value": "test-client-1"}}, {"Set": {"name": "servicecallout.request.formparam.client_id", "success": true, "value": "test-client-1"}}, {"Get": {"name": "servicecallout.request"}}, {"Get": {"name": "identity-service-config.cis2.access_token_path", "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "servicecallout.requesturi", "success": true, "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "apigee.metrics.policy.ServiceCallout.PostTokenCis2.timeTaken", "success": true, "value": "257586"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.PostTokenCis2.target.url"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.PostTokenCis2.expectedcn"}}, {"Get": {"name": "dynamic.target"}}, {"Get": {"name": "servicecallout.requesturi", "value": "/auth/realms/cis2-mock/protocol/openid-connect/token"}}, {"Set": {"name": "apigee.metrics.policy.ServiceCallout.PostTokenCis2.timeTaken", "success": true, "value": "24605631"}}, {"Set": {"name": "servicecallout.ServiceCallout.PostTokenCis2.failed", "success": true, "value": "false"}}, {"Get": {"name": "idp", "value": "null"}}]}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "extractvariables"}, {"name": "type", "value": "ExtractVariablesExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ExtractVariables.AccessToken"}, {"name": "stepDefinition-name", "value": "ExtractVariables.AccessToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:573"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "externalAccessToken", "success": true, "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiI1OWNlZjg3NC02N2Q4LTRlMDAtODMwNy1mNTUyNjNhZGNhOWEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsInN1YiI6IjQyM2RmZjY3LWUwODUtNGIwNC04NDdmLTQ5MDE1NmJjNzY5MyIsInR5cCI6IkJlYXJlciIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiMSIsInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgbmF0aW9uYWxyYmFjYWNjZXNzIGVtYWlsIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.tmJHeYXKP3zZdsngkrO4csP7hGuOoGuvIYlrlK8pOIv_JV7uxVcvtQbpaM9rze-gn3vllccrHML68bC56UIp1p13lDd3UxajyEQdaYxUKEWGHEpM43di5Gsb4oXZXL45Cq-003ykUZjtvvsASHV_Aiw0kC6quhiRjhUKAFJrgbRTh6jxz0YJr8EfHNR0TL8dRqQAFGJeSM0u0aF6ltSZ9X3LHWogyRgMyOe96wFLV54C4lkNnbvkLudMJ282p0JalfV1LMpWXj0hHnS-_IdrLxBT_WxI1u9OKtHvwPxtbCfRJ69VmIDIC07ib8kO94QEPCSjOyGvi-a2x1Jzi2et2A"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "externalRefreshToken", "success": true, "value": "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI0YWFiNzljOC02NWM2LTRlN2QtYTIzOC0xYTcwMjIwMWVjMjMifQ.eyJleHAiOjE2MzYwMzkyNjYsImlhdCI6MTYzNjAzNzQ2NiwianRpIjoiNWVlNzJhNDgtMWM1MS00NTcxLTk2OWYtY2NlMDE0MTE2MjBjIiwiaXNzIjoiaHR0cHM6Ly9pZGVudGl0eS5wdGwuYXBpLnBsYXRmb3JtLm5ocy51ay9hdXRoL3JlYWxtcy9jaXMyLW1vY2siLCJhdWQiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsInN1YiI6IjQyM2RmZjY3LWUwODUtNGIwNC04NDdmLTQ5MDE1NmJjNzY5MyIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJ0ZXN0LWNsaWVudC0xIiwic2Vzc2lvbl9zdGF0ZSI6IjIzZjZkZjQyLWFiOTYtNDM0OC1iNWQzLTI2OTYwODlkZWRhMCIsInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgbmF0aW9uYWxyYmFjYWNjZXNzIGVtYWlsIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIn0.hFqRVgR6ncSG0bZJd0eFXPxX_ucJd4H_2GDpunk1Rbo"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "externalIdToken", "success": true, "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiJlOTQxMmQyZC00N2MzLTRiMTAtYTU5YS1jNTUwNTUzZjFjNjEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsImF1ZCI6InRlc3QtY2xpZW50LTEiLCJzdWIiOiI0MjNkZmY2Ny1lMDg1LTRiMDQtODQ3Zi00OTAxNTZiYzc2OTMiLCJ0eXAiOiJJRCIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYXRfaGFzaCI6IkJybHl6bzg2Q09FODk5VUc2ZGxNd2ciLCJhY3IiOiIxIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.L2bi1o1uFLi2A65r069mBxw0GWqRnwdX1wNwK39Tt0jmbhNlMXJ5cRZGDkvzkrnIsCFJa6kZyvV8UybQl36lQLYYft5UT8XYXonE9buwMTw2UtfoGlJ6m99iKe2XjtmVLRGSiJX_3jM6Y6eYiecWIT4kjP79V5dpLe8AMwoSgnkxyXsDyo6K-Lc0xm6EOQ_9CLZmPbKDnaB2gdSlicmgsRbAh3gkj45KaRAi0_MW6UMIghO9RD8IQdazo4-sFOSc9LeyOpu2wtQdrXcdHLu9Sn_C3RRlMBfCkVVOSCMKUt-ea7_Zhab1EB2IwmOimK94P7hbkmRr0NSw2nIsDjfggg"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "externalTokenExpiresIn", "success": true, "value": "300"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "token_type", "success": true, "value": "Bearer"}}, {"Set": {"name": "apigee.metrics.policy.ExtractVariables.AccessToken.timeTaken", "success": true, "value": "326170"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "JWT"}, {"name": "type", "value": "DecodeJWTStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "DecodeJWT.FromExternalIdToken"}, {"name": "stepDefinition-name", "value": "DecodeJWT.FromExternalIdToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:574"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "externalIdToken", "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiJlOTQxMmQyZC00N2MzLTRiMTAtYTU5YS1jNTUwNTUzZjFjNjEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsImF1ZCI6InRlc3QtY2xpZW50LTEiLCJzdWIiOiI0MjNkZmY2Ny1lMDg1LTRiMDQtODQ3Zi00OTAxNTZiYzc2OTMiLCJ0eXAiOiJJRCIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYXRfaGFzaCI6IkJybHl6bzg2Q09FODk5VUc2ZGxNd2ciLCJhY3IiOiIxIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.L2bi1o1uFLi2A65r069mBxw0GWqRnwdX1wNwK39Tt0jmbhNlMXJ5cRZGDkvzkrnIsCFJa6kZyvV8UybQl36lQLYYft5UT8XYXonE9buwMTw2UtfoGlJ6m99iKe2XjtmVLRGSiJX_3jM6Y6eYiecWIT4kjP79V5dpLe8AMwoSgnkxyXsDyo6K-Lc0xm6EOQ_9CLZmPbKDnaB2gdSlicmgsRbAh3gkj45KaRAi0_MW6UMIghO9RD8IQdazo4-sFOSc9LeyOpu2wtQdrXcdHLu9Sn_C3RRlMBfCkVVOSCMKUt-ea7_Zhab1EB2IwmOimK94P7hbkmRr0NSw2nIsDjfggg"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.header-json", "success": true, "value": "{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"typ\":\"JWT\",\"alg\":\"RS256\"}"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.header-claim-names", "success": true, "value": "[kid, typ, alg]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.header.kid", "success": true, "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.header.kid", "success": true, "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.header.type", "success": true, "value": "JWT"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.header.typ", "success": true, "value": "JWT"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.header.algorithm", "success": true, "value": "RS256"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.header.alg", "success": true, "value": "RS256"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.warning", "success": true, "value": "possible duplicate key in original JWT payload"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.payload-json", "success": true, "value": "{\"at_hash\":\"Brlyzo86COE899UG6dlMwg\",\"sub\":\"423dff67-e085-4b04-847f-490156bc7693\",\"auditTrackingId\":\"91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391\",\"amr\":[\"N3_SMARTCARD\"],\"iss\":\"https:\\/\\/identity.ptl.api.platform.nhs.uk\\/auth\\/realms\\/cis2-mock\",\"typ\":\"ID\",\"sid\":\"23f6df42-ab96-4348-b5d3-2696089deda0\",\"aud\":\"test-client-1\",\"acr\":\"AAL3_ANY\",\"azp\":\"test-client-1\",\"auth_time\":1636037466,\"exp\":1636037766,\"session_state\":\"23f6df42-ab96-4348-b5d3-2696089deda0\",\"iat\":1636037466,\"jti\":\"e9412d2d-47c3-4b10-a59a-c550553f1c61\"}"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.payload-claim-names", "success": true, "value": "[at_hash, sub, auditTrackingId, amr, iss, typ, sid, aud, acr, azp, auth_time, exp, session_state, iat, jti]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.at_hash", "success": true, "value": "Brlyzo86COE899UG6dlMwg"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.at_hash", "success": true, "value": "Brlyzo86COE899UG6dlMwg"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.subject", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.sub", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.auditTrackingId", "success": true, "value": "91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.auditTrackingId", "success": true, "value": "91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.amr", "success": true, "value": "[N3_SMARTCARD]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.amr", "success": true, "value": "[\"N3_SMARTCARD\"]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.issuer", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.iss", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.typ", "success": true, "value": "ID"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.type", "success": true, "value": "ID"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.sid", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.sid", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.audience", "success": true, "value": "[test-client-1]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.aud", "success": true, "value": "[\"test-client-1\"]"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.acr", "success": true, "value": "AAL3_ANY"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.acr", "success": true, "value": "AAL3_ANY"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.azp", "success": true, "value": "test-client-1"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.azp", "success": true, "value": "test-client-1"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.auth_time", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.auth_time", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.expiry", "success": true, "value": "1636037766000"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.exp", "success": true, "value": "1636037766"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.expiry_formatted", "success": true, "value": "2021-11-04T14:56:06.000+0000"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.seconds_remaining", "success": true, "value": "299"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.time_remaining_formatted", "success": true, "value": "0:04:59.426"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.session_state", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.session_state", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.issuedat", "success": true, "value": "1636037466000"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.iat", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.issuedat_formatted", "success": true, "value": "2021-11-04T14:51:06.000+0000"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.id", "success": true, "value": "e9412d2d-47c3-4b10-a59a-c550553f1c61"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.jti", "success": true, "value": "e9412d2d-47c3-4b10-a59a-c550553f1c61"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.is_expired", "success": true, "value": "false"}}, {"Set": {"name": "jwt.DecodeJWT.FromExternalIdToken.signed", "success": true, "value": "true"}}, {"Set": {"name": "apigee.metrics.policy.DecodeJWT.FromExternalIdToken.timeTaken", "success": true, "value": "701418"}}]}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "validate-id-token-claims.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "Javascript.ValidateIDTokenClaims"}, {"name": "stepDefinition-name", "value": "Javascript.ValidateIDTokenClaims"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:575"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "idp", "value": "null"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.aud", "value": "[\"test-client-1\"]"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.iss", "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Get": {"name": "identity-service-config.cis2.client_id", "value": "test-client-1"}}, {"Get": {"name": "identity-service-config.cis2.issuer", "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "apigee.metrics.policy.Javascript.ValidateIDTokenClaims.timeTaken", "success": true, "value": "732903"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(claims_validation.is_valid equals false)"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.JWTClaimsInvalid"}, {"name": "stepDefinition-name", "value": "RaiseFault.JWTClaimsInvalid"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:575"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "idp", "value": "null"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.aud", "value": "[\"test-client-1\"]"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.iss", "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Get": {"name": "identity-service-config.cis2.client_id", "value": "test-client-1"}}, {"Get": {"name": "identity-service-config.cis2.issuer", "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "apigee.metrics.policy.Javascript.ValidateIDTokenClaims.timeTaken", "success": true, "value": "732903"}}, {"Get": {"name": "claims_validation.is_valid"}}]}]}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "lookupcache.LookupCache.JWKS.cachehit", "value": "false"}, {"name": "lookupcache.LookupCache.JWKS.fault.name", "value": ""}, {"name": "lookupcache.LookupCache.JWKS.isEncrypted", "value": "false"}, {"name": "lookupcache.LookupCache.JWKS.assignto", "value": "jwks"}, {"name": "lookupcache.LookupCache.JWKS.cachekey", "value": "nhsd-nonprod__internal-dev__identity-service-pr-251____jwks"}, {"name": "lookupcache.LookupCache.JWKS.cachename", "value": "nhsd-nonprod__internal-dev"}, {"name": "lookupcache.LookupCache.JWKS.fault.cause", "value": ""}, {"name": "lookupcache.LookupCache.JWKS.failed", "value": "false"}]}, "timestamp": "04-11-21 14:51:06:575"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "PAUSE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "lookupcache"}, {"name": "type", "value": "LookupCacheExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "LookupCache.JWKS"}, {"name": "stepDefinition-name", "value": "LookupCache.JWKS"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:575"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "lookupcache.LookupCache.JWKS"}}, {"Get": {"name": "target"}}, {"Set": {"name": "apigee.metrics.policy.LookupCache.JWKS.timeTaken", "success": true, "value": "75716"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "validate-claim-external-id-token.js"}, {"name": "expression", "value": "(jwks not equals null)"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "true"}, {"name": "stepDefinition-displayName", "value": "JavaScript.ValidateClaimFromExternalIdToken"}, {"name": "stepDefinition-name", "value": "JavaScript.ValidateClaimFromExternalIdToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:578"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.header.kid", "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwks_kid_found", "success": true, "value": "true"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.ValidateClaimFromExternalIdToken.timeTaken", "success": true, "value": "424610"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "servicecallout"}, {"name": "expression", "value": "(((jwks equals null) or (jwks_kid_found equals false)) and (idp not equals \"nhs-login\"))"}, {"name": "type", "value": "ServiceCalloutExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ServiceCallout.GetJWKS"}, {"name": "stepDefinition-name", "value": "ServiceCallout.GetJWKS"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:578"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.header.kid", "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwks_kid_found", "success": true, "value": "true"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.ValidateClaimFromExternalIdToken.timeTaken", "success": true, "value": "424610"}}, {"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwks_kid_found", "value": "true"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "servicecallout"}, {"name": "expression", "value": "(((jwks equals null) or (jwks_kid_found equals false)) and (idp equals \"nhs-login\"))"}, {"name": "type", "value": "ServiceCalloutExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ServiceCallout.GetNHSLoginJWKS"}, {"name": "stepDefinition-name", "value": "ServiceCallout.GetNHSLoginJWKS"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:578"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwks_kid_found", "value": "true"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "populatecache"}, {"name": "expression", "value": "((jwks equals null) or (jwks_kid_found equals false))"}, {"name": "type", "value": "PopulateCacheExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "PopulateCache.JWKS"}, {"name": "stepDefinition-name", "value": "PopulateCache.JWKS"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:578"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwks_kid_found", "value": "true"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "expression", "value": "((jwks equals null) or (jwks_kid_found equals false))"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.JWKS"}, {"name": "stepDefinition-name", "value": "AssignMessage.JWKS"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:578"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Get": {"name": "jwks_kid_found", "value": "true"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "JWT"}, {"name": "type", "value": "VerifyJWTStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "VerifyJWT.FromExternalIdToken"}, {"name": "stepDefinition-name", "value": "VerifyJWT.FromExternalIdToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:579"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.valid", "success": true, "value": "false"}}, {"Get": {"name": "externalIdToken", "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiJlOTQxMmQyZC00N2MzLTRiMTAtYTU5YS1jNTUwNTUzZjFjNjEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsImF1ZCI6InRlc3QtY2xpZW50LTEiLCJzdWIiOiI0MjNkZmY2Ny1lMDg1LTRiMDQtODQ3Zi00OTAxNTZiYzc2OTMiLCJ0eXAiOiJJRCIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYXRfaGFzaCI6IkJybHl6bzg2Q09FODk5VUc2ZGxNd2ciLCJhY3IiOiIxIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.L2bi1o1uFLi2A65r069mBxw0GWqRnwdX1wNwK39Tt0jmbhNlMXJ5cRZGDkvzkrnIsCFJa6kZyvV8UybQl36lQLYYft5UT8XYXonE9buwMTw2UtfoGlJ6m99iKe2XjtmVLRGSiJX_3jM6Y6eYiecWIT4kjP79V5dpLe8AMwoSgnkxyXsDyo6K-Lc0xm6EOQ_9CLZmPbKDnaB2gdSlicmgsRbAh3gkj45KaRAi0_MW6UMIghO9RD8IQdazo4-sFOSc9LeyOpu2wtQdrXcdHLu9Sn_C3RRlMBfCkVVOSCMKUt-ea7_Zhab1EB2IwmOimK94P7hbkmRr0NSw2nIsDjfggg"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.header-json", "success": true, "value": "{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"typ\":\"JWT\",\"alg\":\"RS256\"}"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.header-claim-names", "success": true, "value": "[kid, typ, alg]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.header.kid", "success": true, "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.header.kid", "success": true, "value": "JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.header.type", "success": true, "value": "JWT"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.header.typ", "success": true, "value": "JWT"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.header.algorithm", "success": true, "value": "RS256"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.header.alg", "success": true, "value": "RS256"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.signed", "success": true, "value": "true"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.warning", "success": true, "value": "possible duplicate key in original JWT payload"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.payload-json", "success": true, "value": "{\"at_hash\":\"Brlyzo86COE899UG6dlMwg\",\"sub\":\"423dff67-e085-4b04-847f-490156bc7693\",\"auditTrackingId\":\"91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391\",\"amr\":[\"N3_SMARTCARD\"],\"iss\":\"https:\\/\\/identity.ptl.api.platform.nhs.uk\\/auth\\/realms\\/cis2-mock\",\"typ\":\"ID\",\"sid\":\"23f6df42-ab96-4348-b5d3-2696089deda0\",\"aud\":\"test-client-1\",\"acr\":\"AAL3_ANY\",\"azp\":\"test-client-1\",\"auth_time\":1636037466,\"exp\":1636037766,\"session_state\":\"23f6df42-ab96-4348-b5d3-2696089deda0\",\"iat\":1636037466,\"jti\":\"e9412d2d-47c3-4b10-a59a-c550553f1c61\"}"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.payload-claim-names", "success": true, "value": "[at_hash, sub, auditTrackingId, amr, iss, typ, sid, aud, acr, azp, auth_time, exp, session_state, iat, jti]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.at_hash", "success": true, "value": "Brlyzo86COE899UG6dlMwg"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.at_hash", "success": true, "value": "Brlyzo86COE899UG6dlMwg"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.subject", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.sub", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.auditTrackingId", "success": true, "value": "91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.auditTrackingId", "success": true, "value": "91f694e6-3749-42fd-90b0-DONOTCHANGE-1546391"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.amr", "success": true, "value": "[N3_SMARTCARD]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.amr", "success": true, "value": "[\"N3_SMARTCARD\"]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.issuer", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.iss", "success": true, "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.typ", "success": true, "value": "ID"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.type", "success": true, "value": "ID"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.sid", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.sid", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.audience", "success": true, "value": "[test-client-1]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.aud", "success": true, "value": "[\"test-client-1\"]"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.acr", "success": true, "value": "AAL3_ANY"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.acr", "success": true, "value": "AAL3_ANY"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.azp", "success": true, "value": "test-client-1"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.azp", "success": true, "value": "test-client-1"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.auth_time", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.auth_time", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.expiry", "success": true, "value": "1636037766000"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.exp", "success": true, "value": "1636037766"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.expiry_formatted", "success": true, "value": "2021-11-04T14:56:06.000+0000"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.seconds_remaining", "success": true, "value": "299"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.time_remaining_formatted", "success": true, "value": "0:04:59.421"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.session_state", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.session_state", "success": true, "value": "23f6df42-ab96-4348-b5d3-2696089deda0"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.issuedat", "success": true, "value": "1636037466000"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.iat", "success": true, "value": "1636037466"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.issuedat_formatted", "success": true, "value": "2021-11-04T14:51:06.000+0000"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.claim.id", "success": true, "value": "e9412d2d-47c3-4b10-a59a-c550553f1c61"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.decoded.claim.jti", "success": true, "value": "e9412d2d-47c3-4b10-a59a-c550553f1c61"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.is_expired", "success": true, "value": "false"}}, {"Get": {"name": "jwks", "value": "{\"keys\":[{\"kid\":\"wmjqls_RN0D2hT9OdwpwXx4gaY8-3fNYPBevRqcHE3Y\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"enc\",\"n\":\"gWev5r3fMN3x7AMKR1-5GCG7BRWDrXOsoHxh9foFU-wjJfysSbZXOfVyvAQU-66FRuVw9TOQrCBVaBd-N9mr6JQVtTSvjZpmuN1brP_xg_emOa4aAaJdYTmiR5GrTvZSmli0zGlgTwpY5K9G7_N_Y91_dEoidWQDHPLUXq1Ug9RFYnnGOKPCGurhTIrSRUUK0XuhGI-11JexUl6r1O9_ZuU3wmXlXNBFcMQ-Fz5S6_eL5t0JFz4HCQDe2kJnRlrX5hX5m_Tnqkhr2jx0RlS0uVGydQPrBJV5D5l45Pddf9XVE_XdiQIljg11xsDj9rp2y8mlkuSr-_i3Cv2cY6Simw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vKqzANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCBZ6/mvd8w3fHsAwpHX7kYIbsFFYOtc6ygfGH1+gVT7CMl/KxJtlc59XK8BBT7roVG5XD1M5CsIFVoF3432avolBW1NK+Nmma43Vus//GD96Y5rhoBol1hOaJHkatO9lKaWLTMaWBPCljkr0bv839j3X90SiJ1ZAMc8tRerVSD1EViecY4o8Ia6uFMitJFRQrRe6EYj7XUl7FSXqvU739m5TfCZeVc0EVwxD4XPlLr94vm3QkXPgcJAN7aQmdGWtfmFfmb9OeqSGvaPHRGVLS5UbJ1A+sElXkPmXjk911/1dUT9d2JAiWODXXGwOP2unbLyaWS5Kv7+LcK/ZxjpKKbAgMBAAEwDQYJKoZIhvcNAQELBQADggEBADJdAf40cAVFJWulI37N8OLRN2vH1PiRgXTs/j7POhyay+gO9F5dX3tcOn279kDcYsl9z3jUAfDxzda7ZCtVGw6mzg+306NweBZjVPjaDvNB1q1hbFo60OlaY6Zl+HFEWtJx5L0IDHGq9eRtZYBGWVqhq1Bvxa+zbJCtrBuxf14aRFKnFIIpSEQfW+Ohv8piFX4+sMIpxRjEAxB92UjK3eSJa1Ttm6h6kAUb6M4fruoYaAhk/1duLZJrFUlXjRisbgQpE74TcvgSuTLMX+1C334TZj9E4MOYG6X9nKjZtVdkvYdRkTBd9CfO3TYBOk6WincF1XWGagiBqwm0Edrz1ww=\"],\"x5t\":\"bEOMBPbwLyUl8PbgGnNNJ4RfCIc\",\"x5t#S256\":\"G1MyQTb5os03Z-wBKCti-FUMIMTN-OxwZuethrD8dcM\"},{\"kid\":\"JcyBMOKD1vFxIH0hYRzbKksuvwt24IwtHEINpKrJzZY\",\"kty\":\"RSA\",\"alg\":\"RS256\",\"use\":\"sig\",\"n\":\"vqe4T7e_Gvq5yAivklbovdeD9fB0jpoDC2V0iEZwODyGqGHCHFle8E7hBwODimC733GFNJKAeYXKmyVMbL7htLQMrt9d1452MhSoXCx-kfi-Vcb3tppDLoQBNKVIYNDrk6d5DF9c8tFWJmcFH7zWk8nqqtwXOie4P3HDArl4cs-tq1XKq78bcBEnZTZBgylxMi7bz78M1cEl8zBz9lu3pmrfB_ya8RKaSWV2DpUQdKPk2JT_p5fRDOm-FD19dRaIh39jHJVm_cNz_zjyBeWrY8fwNUMYwl7ljAuOoy5V9pbmRLCc462o-Cjnv2HOsie8c7fL9mfrcTNPQIa1pi-rcw\",\"e\":\"AQAB\",\"x5c\":[\"MIICoTCCAYkCBgF8l8vLcDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAljaXMyLW1vY2swHhcNMjExMDE5MDkwMzA3WhcNMzExMDE5MDkwNDQ3WjAUMRIwEAYDVQQDDAljaXMyLW1vY2swggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+p7hPt78a+rnICK+SVui914P18HSOmgMLZXSIRnA4PIaoYcIcWV7wTuEHA4OKYLvfcYU0koB5hcqbJUxsvuG0tAyu313XjnYyFKhcLH6R+L5Vxve2mkMuhAE0pUhg0OuTp3kMX1zy0VYmZwUfvNaTyeqq3Bc6J7g/ccMCuXhyz62rVcqrvxtwESdlNkGDKXEyLtvPvwzVwSXzMHP2W7emat8H/JrxEppJZXYOlRB0o+TYlP+nl9EM6b4UPX11FoiHf2MclWb9w3P/OPIF5atjx/A1QxjCXuWMC46jLlX2luZEsJzjraj4KOe/Yc6yJ7xzt8v2Z+txM09AhrWmL6tzAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAEZC1fN/x/KCl6w8sviUlE6uI68Zo0Wt1r0nQkD2Mq8DlDjwPqrRn56IeANjwYz1DoRg3qo87vcBwCke+oDU9vF5HLPLwnAM90VuKOTuE4u+fTDjOr1s7tbrRkZ0JyY90tJ7e6MyfN/TsErWdA57bd0mXpe80d0lShi0pHFOp4Szuld5PgmfXTBmI+vWcqo447w02ZZps0UB1ep/511rnXiL+9mO7MiVekF6OnZp20I+ISIgAgLWijEDY5OtAIQDVJ3Xj1a3gV8gb2++tH3VELhqt4sewcXbX5r0C59IHOEeg/LTXpnzi1CYTTDIkSn7U8Tn3ErhphInzrvtT6SOIfE=\"],\"x5t\":\"mm270sH_j9fmIb_RQX7bwiaqTas\",\"x5t#S256\":\"es1K2skRe2ZqiCtTrmv3B_R4v6cBhCkcBbJjaqEc830\"}]}"}}, {"Set": {"name": "jwt.VerifyJWT.FromExternalIdToken.valid", "success": true, "value": "true"}}, {"Set": {"name": "apigee.metrics.policy.VerifyJWT.FromExternalIdToken.timeTaken", "success": true, "value": "1032765"}}]}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "filter-user-restricted-scopes.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "JavaScript.FilterUserRestrictedScopes"}, {"name": "stepDefinition-name", "value": "JavaScript.FilterUserRestrictedScopes"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:580"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "idp", "value": "null"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.acr", "value": "AAL3_ANY"}}, {"Get": {"name": "original_scope", "value": "urn:nhsd:apim:user-nhs-login:P9:some-api urn:nhsd:apim:app:level3: urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service urn:nhsd:apim:user-nhs-login:P5:some-api personal-demographics-service:USER-RESTRICTED urn:nhsd:apim:user-nhs-login:P0:some-api"}}, {"Set": {"name": "apigee.user_restricted_scopes", "success": true, "value": "urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.FilterUserRestrictedScopes.timeTaken", "success": true, "value": "499455"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "raisefault"}, {"name": "expression", "value": "(apigee.user_restricted_scopes equals \"\")"}, {"name": "type", "value": "RaiseFaultExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "RaiseFault.VerifyAccessLevel"}, {"name": "stepDefinition-name", "value": "RaiseFault.VerifyAccessLevel"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:580"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "idp", "value": "null"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.decoded.claim.acr", "value": "AAL3_ANY"}}, {"Get": {"name": "original_scope", "value": "urn:nhsd:apim:user-nhs-login:P9:some-api urn:nhsd:apim:app:level3: urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service urn:nhsd:apim:user-nhs-login:P5:some-api personal-demographics-service:USER-RESTRICTED urn:nhsd:apim:user-nhs-login:P0:some-api"}}, {"Set": {"name": "apigee.user_restricted_scopes", "success": true, "value": "urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.FilterUserRestrictedScopes.timeTaken", "success": true, "value": "499455"}}, {"Get": {"name": "apigee.user_restricted_scopes", "value": "urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service"}}]}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "set-logging-fields.js"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "JavaScript.SetLoggingFields"}, {"name": "stepDefinition-name", "value": "JavaScript.SetLoggingFields"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "RequestMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "uRI": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383", "verb": "GET"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "request.formparam.grant_type"}}, {"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}, {"Get": {"name": "identity-service-config.cis2.issuer", "value": "https://identity.ptl.api.platform.nhs.uk/auth/realms/cis2-mock"}}, {"Get": {"name": "identity-service-config.nhs_login.issuer", "value": "https://internal-dev.api.service.nhs.uk"}}, {"Get": {"name": "idp", "value": "null"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.nhs_number"}}, {"Get": {"name": "jwt.VerifyJWT.SubjectToken.claim.nhs_number"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.acr", "value": "AAL3_ANY"}}, {"Get": {"name": "jwt.DecodeJWT.FromExternalIdToken.claim.subject", "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "splunk.auth.grant_type", "success": true, "value": "authorization_code"}}, {"Set": {"name": "splunk.auth.type", "success": true, "value": "user"}}, {"Set": {"name": "splunk.auth.provider", "success": true, "value": "nhs-cis2"}}, {"Set": {"name": "splunk.auth.level", "success": true, "value": "aal3"}}, {"Set": {"name": "splunk.auth.user_id", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "accesstoken.auth_grant_type", "success": true, "value": "authorization_code"}}, {"Set": {"name": "accesstoken.auth_type", "success": true, "value": "user"}}, {"Set": {"name": "accesstoken.auth_level", "success": true, "value": "aal3"}}, {"Set": {"name": "accesstoken.auth_provider", "success": true, "value": "nhs-cis2"}}, {"Set": {"name": "accesstoken.auth_user_id", "success": true, "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.SetLoggingFields.timeTaken", "success": true, "value": "231288"}}]}]}, {"id": "Resumed", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "PostFlow"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "PostFlow"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /_ping and ((request.verb equals \"GET\") or (request.verb equals \"HEAD\")))"}, {"name": "Tree", "value": "TARGET_SELECTOR"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /userinfo and (request.verb equals \"GET\"))"}, {"name": "Tree", "value": "TARGET_SELECTOR"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "type", "value": "EchoRequestExecution"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}], "reasonPhrase": "OK", "statusCode": "200"}, {"ActionResult": "VariableAccess", "accessList": []}]}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "PROXY_RESP_FLOW"}, {"name": "From", "value": "PROXY_REQ_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Accept", "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}, {"name": "Accept-Encoding", "value": "gzip,deflate,br"}, {"name": "Accept-Language", "value": "en-US,en;q=0.9"}, {"name": "Cache-Control", "value": "max-age=0"}, {"name": "Host", "value": "internal-dev.api.service.nhs.uk"}, {"name": "NHSD-Correlation-ID", "value": "..rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "NHSD-Request-ID", "value": ""}, {"name": "sec-ch-ua", "value": "Google Chrome\";v=\"95,\"Chromium\";v=\"95\",\";Not A Brand\";v=\"99\""}, {"name": "sec-ch-ua-mobile", "value": "?0"}, {"name": "sec-ch-ua-platform", "value": "Linux"}, {"name": "Sec-Fetch-Dest", "value": "document"}, {"name": "Sec-Fetch-Mode", "value": "navigate"}, {"name": "Sec-Fetch-Site", "value": "cross-site"}, {"name": "Sec-Fetch-User", "value": "?1"}, {"name": "Upgrade-Insecure-Requests", "value": "1"}, {"name": "User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/95.0.4638.54 Safari/537.36"}, {"name": "X-Forwarded-For", "value": "3.11.106.35"}, {"name": "X-Forwarded-Port", "value": "443"}, {"name": "X-Forwarded-Proto", "value": "https"}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(\"default\" equals proxy.name)"}, {"name": "Tree", "value": "PROXY_default"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.name", "value": "default"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "PreFlow"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "PreFlow"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /_ping and ((request.verb equals \"GET\") or (request.verb equals \"HEAD\")))"}, {"name": "Tree", "value": "AddPayloadToPing_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /authorize and (request.verb equals \"GET\"))"}, {"name": "Tree", "value": "Flow.GetAuthorization_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and ((request.formparam.grant_type equals \"client_credentials\") and (request.formparam.subject_token_type not equals \"urn:ietf:params:oauth:token-type:id_token\"))))"}, {"name": "Tree", "value": "Flow.PostTokenClientCredentials_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and ((request.formparam.subject_token_type equals \"urn:ietf:params:oauth:token-type:id_token\") and (apim.feature_toggles.enable-token-exchange equals true))))"}, {"name": "Tree", "value": "Flow.PostTokenTokenExchange_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /backchannel_logout and (request.verb equals \"POST\"))"}, {"name": "Tree", "value": "Flow.BackChannelLogout_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and (request.formparam.grant_type equals \"authorization_code\")))"}, {"name": "Tree", "value": "Flow.PostTokenAuthorizationCode_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /token and ((request.verb equals \"POST\") and (request.formparam.grant_type equals \"refresh_token\")))"}, {"name": "Tree", "value": "Flow.PostRefreshToken_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(proxy.pathsuffix matches /callback and (request.verb equals \"GET\"))"}, {"name": "Tree", "value": "Flow.GetCallback_RESPONSE_FLOW"}]}, "timestamp": "04-11-21 14:51:06:581"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}, {"Get": {"name": "request.verb", "value": "GET"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "Flow.GetCallback"}, {"name": "proxy.flow.description", "value": "Flow to catch the Code response"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "Flow.GetCallback"}, {"name": "current.flow.description", "value": "Flow to catch the Code response"}]}, "timestamp": "04-11-21 14:51:06:581"}]}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "oauthV2.OAuthV2.GenerateAuthCode.failed", "value": "false"}, {"name": "oauthV2.OAuthV2.GenerateAuthCode.fault.cause", "value": ""}, {"name": "oauthV2.OAuthV2.GenerateAuthCode.fault.name", "value": ""}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "Identifier", "value": "oauthv2client.OAuthV2.GenerateAuthCode"}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "Identifier", "value": "oauthv2authcode.OAuthV2.GenerateAuthCode"}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "oauthV2"}, {"name": "type", "value": "GenerateAuthorizationCodeExecution"}, {"name": "enforcement", "value": "response"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "OAuthV2.GenerateAuthCode"}, {"name": "stepDefinition-name", "value": "OAuthV2.GenerateAuthCode"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&scope=urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "oauthV2.OAuthV2.GenerateAuthCode"}}, {"Get": {"name": "original_response_type", "value": "code"}}, {"Get": {"name": "original_client_id", "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Get": {"name": "apigee.user_restricted_scopes", "value": "urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service"}}, {"Get": {"name": "original_redirect_uri", "value": "https://httpbin.org/anything"}}, {"Get": {"name": "original_state", "value": "45e71699-70ec-4271-8274-c97f76a62f4e"}}, {"Set": {"name": "apigee.developer.id", "success": true, "value": "nhsd-nonprod@@@ba00a768-3783-46f6-bf41-4033d2bf669d"}}, {"Set": {"name": "apigee.developer.app.name", "success": true, "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Set": {"name": "apigee.developer.email", "success": true, "value": "apm-testing-internal-dev@nhs.net"}}, {"Set": {"name": "apigee.client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Set": {"name": "apigee.client_id", "success": true, "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Set": {"name": "oauthV2.failed", "success": true, "value": "false"}}, {"Set": {"name": "apigee.metrics.policy.OAuthV2.GenerateAuthCode.timeTaken", "success": true, "value": "4350362"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "populatecache"}, {"name": "type", "value": "PopulateCacheExecution"}, {"name": "enforcement", "value": "response"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "PopulateCache.ExternalIdToken"}, {"name": "stepDefinition-name", "value": "PopulateCache.ExternalIdToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&scope=urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "target"}}, {"Get": {"name": "oauthv2authcode.OAuthV2.GenerateAuthCode.code", "value": "XCJregni"}}, {"Get": {"name": "externalIdToken", "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiJlOTQxMmQyZC00N2MzLTRiMTAtYTU5YS1jNTUwNTUzZjFjNjEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsImF1ZCI6InRlc3QtY2xpZW50LTEiLCJzdWIiOiI0MjNkZmY2Ny1lMDg1LTRiMDQtODQ3Zi00OTAxNTZiYzc2OTMiLCJ0eXAiOiJJRCIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYXRfaGFzaCI6IkJybHl6bzg2Q09FODk5VUc2ZGxNd2ciLCJhY3IiOiIxIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.L2bi1o1uFLi2A65r069mBxw0GWqRnwdX1wNwK39Tt0jmbhNlMXJ5cRZGDkvzkrnIsCFJa6kZyvV8UybQl36lQLYYft5UT8XYXonE9buwMTw2UtfoGlJ6m99iKe2XjtmVLRGSiJX_3jM6Y6eYiecWIT4kjP79V5dpLe8AMwoSgnkxyXsDyo6K-Lc0xm6EOQ_9CLZmPbKDnaB2gdSlicmgsRbAh3gkj45KaRAi0_MW6UMIghO9RD8IQdazo4-sFOSc9LeyOpu2wtQdrXcdHLu9Sn_C3RRlMBfCkVVOSCMKUt-ea7_Zhab1EB2IwmOimK94P7hbkmRr0NSw2nIsDjfggg"}}, {"Set": {"name": "apigee.metrics.policy.PopulateCache.ExternalIdToken.timeTaken", "success": true, "value": "76068"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "populatecache"}, {"name": "type", "value": "PopulateCacheExecution"}, {"name": "enforcement", "value": "response"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "PopulateCache.ExternalAccessToken"}, {"name": "stepDefinition-name", "value": "PopulateCache.ExternalAccessToken"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&scope=urn:nhsd:apim:user-nhs-id:aal3:personal-demographics-service&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "target"}}, {"Get": {"name": "oauthv2authcode.OAuthV2.GenerateAuthCode.code", "value": "XCJregni"}}, {"Get": {"name": "externalAccessToken", "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3lCTU9LRDF2RnhJSDBoWVJ6Yktrc3V2d3QyNEl3dEhFSU5wS3JKelpZIn0.eyJleHAiOjE2MzYwMzc3NjYsImlhdCI6MTYzNjAzNzQ2NiwiYXV0aF90aW1lIjoxNjM2MDM3NDY2LCJqdGkiOiI1OWNlZjg3NC02N2Q4LTRlMDAtODMwNy1mNTUyNjNhZGNhOWEiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnB0bC5hcGkucGxhdGZvcm0ubmhzLnVrL2F1dGgvcmVhbG1zL2NpczItbW9jayIsInN1YiI6IjQyM2RmZjY3LWUwODUtNGIwNC04NDdmLTQ5MDE1NmJjNzY5MyIsInR5cCI6IkJlYXJlciIsImF6cCI6InRlc3QtY2xpZW50LTEiLCJzZXNzaW9uX3N0YXRlIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiMSIsInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgbmF0aW9uYWxyYmFjYWNjZXNzIGVtYWlsIiwic2lkIjoiMjNmNmRmNDItYWI5Ni00MzQ4LWI1ZDMtMjY5NjA4OWRlZGEwIiwiYWNyIjoiQUFMM19BTlkiLCJhdWRpdFRyYWNraW5nSWQiOiI5MWY2OTRlNi0zNzQ5LTQyZmQtOTBiMC1ET05PVENIQU5HRS0xNTQ2MzkxIiwiYW1yIjpbIk4zX1NNQVJUQ0FSRCJdfQ.tmJHeYXKP3zZdsngkrO4csP7hGuOoGuvIYlrlK8pOIv_JV7uxVcvtQbpaM9rze-gn3vllccrHML68bC56UIp1p13lDd3UxajyEQdaYxUKEWGHEpM43di5Gsb4oXZXL45Cq-003ykUZjtvvsASHV_Aiw0kC6quhiRjhUKAFJrgbRTh6jxz0YJr8EfHNR0TL8dRqQAFGJeSM0u0aF6ltSZ9X3LHWogyRgMyOe96wFLV54C4lkNnbvkLudMJ282p0JalfV1LMpWXj0hHnS-_IdrLxBT_WxI1u9OKtHvwPxtbCfRJ69VmIDIC07ib8kO94QEPCSjOyGvi-a2x1Jzi2et2A"}}, {"Set": {"name": "apigee.metrics.policy.PopulateCache.ExternalAccessToken.timeTaken", "success": true, "value": "41827"}}]}]}, {"id": "Resumed", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "response"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.AuthCodeRedirect"}, {"name": "stepDefinition-name", "value": "AssignMessage.AuthCodeRedirect"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "oauthv2authcode.OAuthV2.GenerateAuthCode.redirect_uri", "value": "https://httpbin.org/anything"}}, {"Get": {"name": "oauthv2authcode.OAuthV2.GenerateAuthCode.code", "value": "XCJregni"}}, {"Get": {"name": "original_state", "value": "45e71699-70ec-4271-8274-c97f76a62f4e"}}, {"Set": {"name": "message.header.Location", "success": true, "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}}, {"Set": {"name": "message.status.code", "success": true, "value": "302"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.AuthCodeRedirect.timeTaken", "success": true, "value": "37752"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "PostFlow"}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "PostFlow"}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "RESP_SENT"}, {"name": "From", "value": "PROXY_RESP_FLOW"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "type", "value": "FlowHookAction"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": []}]}, {"id": "FlowCallout", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "PostProxyFlowHook->PostProxySharedFlow"}]}, "timestamp": "04-11-21 14:51:06:586"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "true"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.SetHSTSHeader"}, {"name": "stepDefinition-name", "value": "AssignMessage.SetHSTSHeader"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "message.header.Strict-Transport-Security", "success": true, "value": "max-age=864000; includeSubDomains"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.SetHSTSHeader.timeTaken", "success": true, "value": "9808"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "expression", "value": "original-request-details.header.X-Correlation-ID matches regular expression .+"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Mirror.CorrelationID"}, {"name": "stepDefinition-name", "value": "AssignMessage.Mirror.CorrelationID"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:586"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "message.header.Strict-Transport-Security", "success": true, "value": "max-age=864000; includeSubDomains"}}, {"Set": {"name": "apigee.metrics.policy.AssignMessage.SetHSTSHeader.timeTaken", "success": true, "value": "9808"}}, {"Get": {"name": "original-request-details.header.X-Correlation-ID"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "assignmessage"}, {"name": "expression", "value": "((flag.custom-header-x-request-id not equals true) and original-request-details.header.X-Request-ID matches regular expression .+)"}, {"name": "type", "value": "AssignMessageExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "AssignMessage.Mirror.RequestID"}, {"name": "stepDefinition-name", "value": "AssignMessage.Mirror.RequestID"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:587"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "flag.custom-header-x-request-id"}}, {"Get": {"name": "original-request-details.header.X-Request-ID"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "flowcallout"}, {"name": "expression", "value": "((apigee.access_token not equals null) and (apigee.access_token not equals \"\"))"}, {"name": "type", "value": "FlowCalloutStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "expressionResult", "value": "false"}, {"name": "stepDefinition-displayName", "value": "FlowCallout.HashAccessToken"}, {"name": "stepDefinition-name", "value": "FlowCallout.HashAccessToken"}, {"name": "stepDefinition-enabled", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:587"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "apigee.access_token"}}]}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "flowcallout"}, {"name": "type", "value": "FlowCalloutStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "FlowCallout.LogApiKeyProtectedEndpoints"}, {"name": "stepDefinition-name", "value": "FlowCallout.LogApiKeyProtectedEndpoints"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:587"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.FlowCallout.LogApiKeyProtectedEndpoints.timeTaken", "success": true, "value": "10335"}}]}]}, {"id": "FlowCallout", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "LogApiKeyProtectedEndpoints"}]}, "timestamp": "04-11-21 14:51:06:587"}]}, {"id": "Paused", "results": []}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "javascript-executionTime", "value": "0"}, {"name": "action", "value": "CONTINUE"}, {"name": "javascript-timeLimit", "value": "200"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "javascript"}, {"name": "javascript-name", "value": "SetLoggingFields.js"}, {"name": "stepExecution-stdout", "value": "accept\naccept-encoding\naccept-language\ncache-control\nhost\nnhsd-correlation-id\nnhsd-request-id\nsec-ch-ua\nsec-ch-ua-mobile\nsec-ch-ua-platform\nsec-fetch-dest\nsec-fetch-mode\nsec-fetch-site\nsec-fetch-user\nupgrade-insecure-requests\nuser-agent\nx-forwarded-for\nx-forwarded-port\nx-forwarded-proto"}, {"name": "type", "value": "JavascriptStepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "JavaScript.SetLoggingFields"}, {"name": "stepDefinition-name", "value": "JavaScript.SetLoggingFields"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:587"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "apigee.client_id", "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Get": {"name": "message.status.code", "value": "302"}}, {"Get": {"name": "apigee.developer.app.name", "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Get": {"name": "accesstoken.auth_grant_type", "value": "authorization_code"}}, {"Get": {"name": "request.headers.names", "value": "[Accept, Accept-Encoding, Accept-Language, Cache-Control, Host, NHSD-Correlation-ID, NHSD-Request-ID, sec-ch-ua, sec-ch-ua-mobile, sec-ch-ua-platform, Sec-Fetch-Dest, Sec-Fetch-Mode, Sec-Fetch-Site, Sec-Fetch-User, Upgrade-Insecure-Requests, User-Agent, X-Forwarded-For, X-Forwarded-Port, X-Forwarded-Proto]"}}, {"Set": {"name": "apigee.metrics.policy.JavaScript.SetLoggingFields.timeTaken", "success": true, "value": "538872"}}]}]}, {"id": "Resumed", "results": []}, {"id": "FlowReturn", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "LogApiKeyProtectedEndpoints"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "FlowReturn", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "PostProxyFlowHook->PostProxySharedFlow"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(\"default\" equals proxy.name)"}, {"name": "Tree", "value": "PROXY_default"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.edge.sharedflow.name", "success": true}}, {"Set": {"name": "apigee.edge.flowhook.name", "success": true}}, {"Get": {"name": "proxy.name", "value": "default"}}]}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "false"}, {"name": "Expression", "value": "(\"identity-server-userinfo\" equals target.name)"}, {"name": "Tree", "value": "TARGET_identity-server-userinfo"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "target.name"}}]}]}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "END"}, {"name": "From", "value": "RESP_SENT"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}], "reasonPhrase": "Found", "statusCode": "302"}]}, {"id": "DebugMask", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "SuccessFullyMaskedConfigs", "value": "[]"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "Resumed", "results": []}, {"id": "StateChange", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "To", "value": "PROXY_POST_RESP_SENT"}, {"name": "From", "value": "END"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Content-Length", "value": "0"}, {"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}, {"name": "X-Apigee.dp.color", "value": "mp-564-210308-0060114-latest-cf6a"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.nat", "value": "prod-geu2a-gnat001"}, {"name": "X-Apigee.proxy", "value": "/organizations/nhsd-nonprod/environments/internal-dev/apiproxies/identity-service-pr-251/revisions/14"}, {"name": "X-Apigee.proxy.basepath", "value": "oauth2-pr-251"}, {"name": "X-Apigee.region", "value": "europe-west2"}], "reasonPhrase": "Found", "statusCode": "302"}]}, {"id": "Condition", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ExpressionResult", "value": "true"}, {"name": "Expression", "value": "(\"default\" equals proxy.name)"}, {"name": "Tree", "value": "PROXY_default"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "proxy.name", "value": "default"}}]}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "proxy.flow.name", "value": "PostClientFlow"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "current.flow.name", "value": "PostClientFlow"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "flowcallout"}, {"name": "type", "value": "StepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "FlowCallout.LogToSplunk"}, {"name": "stepDefinition-name", "value": "FlowCallout.LogToSplunk"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:588"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Content-Length", "value": "0"}, {"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}, {"name": "X-Apigee.dp.color", "value": "mp-564-210308-0060114-latest-cf6a"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.nat", "value": "prod-geu2a-gnat001"}, {"name": "X-Apigee.proxy", "value": "/organizations/nhsd-nonprod/environments/internal-dev/apiproxies/identity-service-pr-251/revisions/14"}, {"name": "X-Apigee.proxy.basepath", "value": "oauth2-pr-251"}, {"name": "X-Apigee.region", "value": "europe-west2"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Set": {"name": "apigee.metrics.policy.FlowCallout.LogToSplunk.timeTaken", "success": true, "value": "7218"}}]}]}, {"id": "FlowCallout", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "LogToSplunk"}]}, "timestamp": "04-11-21 14:51:06:588"}]}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "ServiceCallout.request", "value": "{\"messageID\":\"rrt-3450588342405387872-a-geu2-16400-4719011-2\",\"client\":{\"ip\":\"3.11.106.35\",\"received_start\":\"1636037466496\",\"received_end\":\"1636037466496\",\"sent_start\":\"1636037466588\",\"sent_end\":\"1636037466588\",\"user_agent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\"},\"request\":{\"uri\":\"/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0....."}]}, "timestamp": "04-11-21 14:51:06:589"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "action", "value": "CONTINUE"}, {"name": "stepDefinition-async", "value": "false"}, {"name": "internal", "value": "false"}, {"name": "stepDefinition-type", "value": "servicecallout"}, {"name": "type", "value": "StepExecution"}, {"name": "enforcement", "value": "request"}, {"name": "stepDefinition-continueOnError", "value": "false"}, {"name": "stepDefinition-displayName", "value": "ServiceCallout.LogToSplunk"}, {"name": "stepDefinition-name", "value": "ServiceCallout.LogToSplunk"}, {"name": "stepDefinition-enabled", "value": "true"}, {"name": "result", "value": "true"}]}, "timestamp": "04-11-21 14:51:06:589"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Content-Length", "value": "0"}, {"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}, {"name": "X-Apigee.dp.color", "value": "mp-564-210308-0060114-latest-cf6a"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.nat", "value": "prod-geu2a-gnat001"}, {"name": "X-Apigee.proxy", "value": "/organizations/nhsd-nonprod/environments/internal-dev/apiproxies/identity-service-pr-251/revisions/14"}, {"name": "X-Apigee.proxy.basepath", "value": "oauth2-pr-251"}, {"name": "X-Apigee.region", "value": "europe-west2"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "splunkCalloutRequest"}}, {"Set": {"name": "splunkCalloutRequest.header.Authorization", "success": true, "value": "Splunk 212c99be-0bfb-41cd-b19b-fc50385f2f35"}}, {"Set": {"name": "splunkCalloutRequest.verb", "success": true, "value": "POST"}}, {"Set": {"name": "splunkCalloutRequest.queryparam.index", "success": true, "value": "requests_apm_ptl"}}, {"Get": {"name": "virtualhost.name", "value": "secure"}}, {"Set": {"name": "splunkCalloutRequest.queryparam.host", "success": true, "value": "apigee:secure"}}, {"Get": {"name": "client.received.start.timestamp", "value": "1636037466496"}}, {"Set": {"name": "splunkCalloutRequest.queryparam.time", "success": true, "value": "1636037466496"}}, {"Set": {"name": "splunkCalloutRequest.queryparam.sourcetype", "success": true, "value": "apm-apigee-json"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Set": {"name": "splunkCalloutRequest.queryparam.source", "success": true, "value": "apigee:nhsd-nonprod:internal-dev:identity-service-pr-251:14"}}, {"Get": {"name": "messageid", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}}, {"Get": {"name": "client.ip", "value": "3.11.106.35"}}, {"Get": {"name": "client.received.start.timestamp", "value": "1636037466496"}}, {"Get": {"name": "client.received.end.timestamp", "value": "1636037466496"}}, {"Get": {"name": "client.sent.start.timestamp", "value": "1636037466588"}}, {"Get": {"name": "client.sent.end.timestamp", "value": "1636037466588"}}, {"Get": {"name": "request-data-for-splunk.header.User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36"}}, {"Get": {"name": "request-data-for-splunk.uri", "value": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "request-data-for-splunk.verb", "value": "GET"}}, {"Get": {"name": "request-data-for-splunk.header.Content-Type", "value": ""}}, {"Get": {"name": "client.received.content.length", "value": "0"}}, {"Get": {"name": "request-data-for-splunk.header.Content-Encoding"}}, {"Get": {"name": "request-data-for-splunk.header.X-Request-ID"}}, {"Get": {"name": "request-data-for-splunk.header.X-Correlation-ID"}}, {"Get": {"name": "request-data-for-splunk.header.Host", "value": "internal-dev.api.service.nhs.uk"}}, {"Get": {"name": "request-data-for-splunk.header.X-Forwarded-Port", "value": "443"}}, {"Get": {"name": "request-data-for-splunk.path", "value": "/oauth2-pr-251/callback"}}, {"Get": {"name": "request-data-for-splunk.querystring", "value": "state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "organization.name", "value": "nhsd-nonprod"}}, {"Get": {"name": "apim.api_guid", "value": "d5a3f4fc-e61f-41f3-ab72-16aa5ef3ff2b"}}, {"Get": {"name": "apim.api_spec_guid", "value": ""}}, {"Get": {"name": "apigee.apiproduct.name", "value": "apim-auto-d8fcd097-70a2-4855-a5ed-38d32918e42b"}}, {"Get": {"name": "apigee.developer.app.name", "value": "apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac"}}, {"Get": {"name": "environment.name", "value": "internal-dev"}}, {"Get": {"name": "apigee.client_id", "value": "8z3lF1KOiIRvua1g5GXvpp5G76BUQazx"}}, {"Get": {"name": "developer.app.id", "value": "d93681cd-e785-4180-9282-7621420b2fac"}}, {"Get": {"name": "app.asid"}}, {"Get": {"name": "apiproxy.name", "value": "identity-service-pr-251"}}, {"Get": {"name": "apiproxy.revision", "value": "14"}}, {"Get": {"name": "proxy.basepath", "value": "oauth2-pr-251"}}, {"Get": {"name": "proxy.pathsuffix", "value": "/callback"}}, {"Get": {"name": "auth.access_token_hash"}}, {"Get": {"name": "accesstoken.auth_user_id", "value": "423dff67-e085-4b04-847f-490156bc7693"}}, {"Get": {"name": "accesstoken.auth_type", "value": "user"}}, {"Get": {"name": "accesstoken.auth_grant_type", "value": "authorization_code"}}, {"Get": {"name": "accesstoken.auth_level", "value": "aal3"}}, {"Get": {"name": "accesstoken.auth_provider", "value": "nhs-cis2"}}, {"Get": {"name": "accesstoken.id_token-acr"}}, {"Get": {"name": "grant_type"}}, {"Get": {"name": "status"}}, {"Get": {"name": "accesstoken.id_token-subject"}}, {"Get": {"name": "accesstoken.id_token-issuer"}}, {"Get": {"name": "scope"}}, {"Get": {"name": "target.host"}}, {"Get": {"name": "target.response.status.code"}}, {"Get": {"name": "target.received.content.length"}}, {"Get": {"name": "target.received.start.timestamp"}}, {"Get": {"name": "target.received.end.timestamp"}}, {"Get": {"name": "target.sent.start.timestamp"}}, {"Get": {"name": "target.sent.end.timestamp"}}, {"Get": {"name": "target.port"}}, {"Get": {"name": "is.error", "value": "false"}}, {"Get": {"name": "apigee.edge.execution.is_policy_error", "value": "0"}}, {"Get": {"name": "apigee.edge.execution.is_target_error", "value": "0"}}, {"Get": {"name": "apigee.edge.execution.fault_policy_name"}}, {"Get": {"name": "apigee.edge.execution.fault_flow_name"}}, {"Get": {"name": "error"}}, {"Get": {"name": "error.content"}}, {"Get": {"name": "error.message"}}, {"Get": {"name": "error.status.code"}}, {"Get": {"name": "error.reason.phrase"}}, {"Get": {"name": "error.transport.message"}}, {"Get": {"name": "error.state"}}, {"Get": {"name": "response.status.code", "value": "302"}}, {"Get": {"name": "response.header.Content-Type"}}, {"Get": {"name": "response.header.Content-Length", "value": "0"}}, {"Get": {"name": "response.header.Content-Encoding"}}, {"Get": {"name": "status.response"}}, {"Set": {"name": "splunkCalloutRequest.content", "success": true, "value": "{\"messageID\":\"rrt-3450588342405387872-a-geu2-16400-4719011-2\",\"client\":{\"ip\":\"3.11.106.35\",\"received_start\":\"1636037466496\",\"received_end\":\"1636037466496\",\"sent_start\":\"1636037466588\",\"sent_end\":\"1636037466588\",\"user_agent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\"},\"request\":{\"uri\":\"/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383\",\"verb\":\"GET\",\"content_type\":\"\",\"content_length\":\"0\",\"content_encoding\":\"\",\"requestID\":\"\",\"correlationID\":\"\",\"host\":\"internal-dev.api.service.nhs.uk\",\"port\":\"443\",\"uri_path\":\"/oauth2-pr-251/callback\",\"uri_params\":\"state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383\"},\"meta\":{\"organization\":\"nhsd-nonprod\",\"api_guid\":\"d5a3f4fc-e61f-41f3-ab72-16aa5ef3ff2b\",\"api_spec_guid\":\"\",\"product\":\"apim-auto-d8fcd097-70a2-4855-a5ed-38d32918e42b\",\"application\":\"apim-auto-c1f392ee-9e5c-4abf-b662-21e88546b8ac\",\"env\":\"internal-dev\",\"client_id\":\"8z3lF1KOiIRvua1g5GXvpp5G76BUQazx\",\"application_id\":\"d93681cd-e785-4180-9282-7621420b2fac\",\"ASID\":\"\"},\"proxy\":{\"name\":\"identity-service-pr-251\",\"revision\":\"14\",\"basepath\":\"oauth2-pr-251\",\"suffix\":\"/callback\"},\"auth\":{\"access_token_hash\":\"\",\"user\":{\"user_id\":\"423dff67-e085-4b04-847f-490156bc7693\"},\"meta\":{\"auth_type\":\"user\",\"grant_type\":\"authorization_code\",\"level\":\"aal3\",\"provider\":\"nhs-cis2\"},\"id_token_acr\":\"\",\"grant_type\":\"\",\"authorization\":\"\",\"id_token_subject\":\"\",\"id_token_issuer\":\"\",\"scope\":\"\"},\"target\":{\"host\":\"\",\"status_code\":\"\",\"content_length\":\"\",\"received_start\":\"\",\"received_end\":\"\",\"sent_start\":\"\",\"sent_end\":\"\",\"port\":\"\"},\"error\":{\"is_error\":\"false\",\"is_policy_error\":\"0\",\"is_target_error\":\"0\",\"policy_error_policy_name\":\"\",\"policy_error_flow_name\":\"\",\"error\":\"\",\"content\":\"\",\"message\":\"\",\"status_code\":\"\",\"reason_phrase\":\"\",\"transport_message\":\"\",\"state\":\"\"},\"response\":{\"status_code\":\"302\",\"content_type\":\"\",\"content_length\":\"0\",\"content_encoding\":\"\",\"content_body\":\"\"}}"}}, {"Set": {"name": "splunkCalloutRequest.header.Content-Type", "success": true, "value": "application/json"}}, {"Get": {"name": "splunkCalloutRequest"}}, {"Set": {"name": "servicecallout.requesturi", "success": true, "value": "/services/collector/raw?index=requests_apm_ptl&host=apigee%3Asecure&time=1636037466496&sourcetype=apm-apigee-json&source=apigee%3Anhsd-nonprod%3Ainternal-dev%3Aidentity-service-pr-251%3A14"}}, {"Set": {"name": "apigee.metrics.policy.ServiceCallout.LogToSplunk.timeTaken", "success": true, "value": "356057"}}]}]}, {"id": "FlowReturn", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "shared.flow.name", "value": "LogToSplunk"}]}, "timestamp": "04-11-21 14:51:06:589"}]}, {"id": "Paused", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "loadbalancing.targetserver", "value": "splunk-cloud-hec"}, {"name": "loadbalancing.isfallback", "value": "false"}, {"name": "loadbalancing.failedservers", "value": "[]"}]}, "timestamp": "04-11-21 14:51:06:589"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "expressionResult", "value": "true"}, {"name": "type", "value": "AnalyticsPredefinedVariablesPublisher"}, {"name": "expression", "value": "(analytics equals null )"}]}, "timestamp": "04-11-21 14:51:06:589"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Content-Length", "value": "0"}, {"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}, {"name": "X-Apigee.dp.color", "value": "mp-564-210308-0060114-latest-cf6a"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.nat", "value": "prod-geu2a-gnat001"}, {"name": "X-Apigee.proxy", "value": "/organizations/nhsd-nonprod/environments/internal-dev/apiproxies/identity-service-pr-251/revisions/14"}, {"name": "X-Apigee.proxy.basepath", "value": "oauth2-pr-251"}, {"name": "X-Apigee.region", "value": "europe-west2"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": []}]}, {"id": "Resumed", "results": []}, {"id": "FlowInfo", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "servicecallout_ServiceCallout.LogToSplunk.totalConnectionTimeMs", "value": "0"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.isTlsEnabled", "value": "true"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.isFromClientPool", "value": "true"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.socketUseCount", "value": "153"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.socketAgeMs", "value": "1007543"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.resolvedAddress", "value": "35.179.10.36"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.isHttpClientCached", "value": "true"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.connectionTlsHandshakeTimeMs", "value": "0"}, {"name": "servicecallout_ServiceCallout.LogToSplunk.connectionStatus", "value": "CONNECTED"}]}, "timestamp": "04-11-21 14:51:06:589"}]}, {"id": "Execution", "results": [{"ActionResult": "DebugInfo", "properties": {"property": [{"name": "expressionResult", "value": "false"}, {"name": "type", "value": "AnalyticsPublisher"}, {"name": "expression", "value": "(analytics not null)"}]}, "timestamp": "04-11-21 14:51:06:589"}, {"ActionResult": "ResponseMessage", "headers": [{"name": "Content-Length", "value": "0"}, {"name": "Location", "value": "https://httpbin.org/anything?code=XCJregni&state=45e71699-70ec-4271-8274-c97f76a62f4e"}, {"name": "Strict-Transport-Security", "value": "max-age=864000; includeSubDomains"}, {"name": "X-Apigee.dp.color", "value": "mp-564-210308-0060114-latest-cf6a"}, {"name": "X-Apigee.Message-ID", "value": "rrt-3450588342405387872-a-geu2-16400-4719011-2"}, {"name": "X-Apigee.nat", "value": "prod-geu2a-gnat001"}, {"name": "X-Apigee.proxy", "value": "/organizations/nhsd-nonprod/environments/internal-dev/apiproxies/identity-service-pr-251/revisions/14"}, {"name": "X-Apigee.proxy.basepath", "value": "oauth2-pr-251"}, {"name": "X-Apigee.region", "value": "europe-west2"}], "reasonPhrase": "Found", "statusCode": "302"}, {"ActionResult": "VariableAccess", "accessList": [{"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.LogToSplunk.target.url"}}, {"Get": {"name": "target.name"}}, {"Get": {"name": "target.basepath"}}, {"Get": {"name": "target.url"}}, {"Get": {"name": "target.host"}}, {"Get": {"name": "target.ip"}}, {"Get": {"name": "client.ip", "value": "3.11.106.35"}}, {"Get": {"name": "is.error", "value": "false"}}, {"Get": {"name": "target.sent.start.timestamp"}}, {"Get": {"name": "target.sent.end.timestamp"}}, {"Get": {"name": "target.received.start.timestamp"}}, {"Get": {"name": "target.received.end.timestamp"}}, {"Get": {"name": "client.received.start.timestamp", "value": "1636037466496"}}, {"Get": {"name": "client.received.end.timestamp", "value": "1636037466496"}}, {"Get": {"name": "client.sent.start.timestamp", "value": "1636037466588"}}, {"Get": {"name": "client.sent.end.timestamp", "value": "1636037466588"}}, {"Get": {"name": "message.status.code", "value": "302"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "envoy.proxy"}}, {"Get": {"name": "servicecallout.ServiceCallout.LogToSplunk.expectedcn"}}, {"Get": {"name": "dynamic.target"}}, {"Get": {"name": "request.uri", "value": "/oauth2-pr-251/callback?state=crfyBxsDkUyR8brfxQQqlDoEqVAVgurqjEht&session_state=23f6df42-ab96-4348-b5d3-2696089deda0&code=059ce9fe-511c-4f99-a62f-4b0ad2265f65.23f6df42-ab96-4348-b5d3-2696089deda0.a8b9fef2-6b06-42bb-88dc-d9e10d4ad383"}}, {"Get": {"name": "request.path", "value": "/oauth2-pr-251/callback"}}, {"Get": {"name": "request.verb", "value": "GET"}}, {"Get": {"name": "flow.resource.name"}}, {"Get": {"name": "sla"}}, {"Get": {"name": "client.received.content.length", "value": "0"}}, {"Get": {"name": "target.received.content.length"}}, {"Get": {"name": "target.response.status.code"}}, {"Get": {"name": "request.header.User-Agent", "value": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36"}}, {"Get": {"name": "request.header.X-Apigee-Client-Device-Id"}}, {"Get": {"name": "request.header.X-Apigee-Client-Session-Id"}}, {"Get": {"name": "request.header.X-Apigee-Client-Org-Name"}}, {"Get": {"name": "request.header.X-Apigee-Client-App-Name"}}, {"Get": {"name": "request.header.X-Apigee-Client-Request-Id"}}, {"Get": {"name": "request.header.X-Forwarded-Proto", "value": "https"}}, {"Get": {"name": "request.header.True-client-ip"}}, {"Get": {"name": "analytics"}}]}]}, {"id": "Paused", "results": []}, {"id": "Resumed", "results": []}, {"id": "Paused", "results": []}]}